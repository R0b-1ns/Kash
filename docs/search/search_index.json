{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Finance Manager","text":"<p>Gestionnaire de finances personnel avec OCR et IA locale.</p>"},{"location":"#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>Upload de documents : Photos de tickets, factures PDF, fiches de paie</li> <li>OCR intelligent : Extraction automatique du texte avec PaddleOCR</li> <li>IA locale : Cat\u00e9gorisation et extraction de donn\u00e9es avec Ollama/Mistral</li> <li>Dashboard interactif : Graphiques, statistiques, suivi de budget</li> <li>Tags personnalisables : Syst\u00e8me de cat\u00e9gorisation flexible</li> <li>Multi-devises : Support des devises pour les voyages</li> <li>Export CSV : Exportez vos donn\u00e9es facilement</li> <li>Synchronisation NAS : Sauvegarde automatique vers votre NAS</li> </ul>"},{"location":"#stack-technique","title":"Stack technique","text":"Composant Technologie Backend FastAPI, SQLAlchemy, PostgreSQL Frontend React 18, TypeScript, Tailwind CSS OCR PaddleOCR IA Ollama avec Mistral 7B Conteneurisation Docker Compose"},{"location":"#demarrage-rapide","title":"D\u00e9marrage rapide","text":"<pre><code># Cloner le projet\ngit clone &lt;repository&gt;\ncd gestionnaireDeFinance\n\n# Configurer l'environnement\ncp .env.example .env\n\n# Lancer avec Docker\ndocker-compose up -d\n\n# Acc\u00e9der \u00e0 l'application\nopen http://localhost:3000\n</code></pre>"},{"location":"#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Frontend (React)                      \u2502\n\u2502                   http://localhost:3000                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502 API REST\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Backend (FastAPI)                      \u2502\n\u2502                   http://localhost:8000                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502   OCR   \u2502  \u2502   IA    \u2502  \u2502  Export \u2502  \u2502   Sync  \u2502    \u2502\n\u2502  \u2502 Service \u2502  \u2502 Service \u2502  \u2502 Service \u2502  \u2502 Service \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502       \u2502            \u2502                          \u2502         \u2502\n\u2502       \u25bc            \u25bc                          \u25bc         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  \u2502PaddleOCR\u2502  \u2502 Ollama  \u2502              \u2502  rsync  \u2502     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502                       \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502  PostgreSQL   \u2502        \u2502     NAS     \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#liens-utiles","title":"Liens utiles","text":"<ul> <li>Guide d'installation</li> <li>Configuration</li> <li>API Reference</li> <li>Documentation Swagger</li> </ul>"},{"location":"api/auth/","title":"API Authentification","text":"<p>Base URL: <code>/api/v1/auth</code></p>"},{"location":"api/auth/#endpoints","title":"Endpoints","text":""},{"location":"api/auth/#post-register","title":"POST /register","text":"<p>Cr\u00e9e un nouveau compte utilisateur.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\",\n  \"name\": \"John Doe\"\n}\n</code></pre></p> <p>Response (201): <pre><code>{\n  \"id\": 1,\n  \"email\": \"user@example.com\",\n  \"name\": \"John Doe\",\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p> <p>Erreurs:</p> Code Description 400 Email d\u00e9j\u00e0 utilis\u00e9 422 Donn\u00e9es invalides"},{"location":"api/auth/#post-login","title":"POST /login","text":"<p>Authentifie un utilisateur et retourne un token JWT.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\"\n}\n</code></pre></p> <p>Response (200): <pre><code>{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIs...\",\n  \"token_type\": \"bearer\"\n}\n</code></pre></p> <p>Erreurs:</p> Code Description 401 Email ou mot de passe incorrect 422 Donn\u00e9es invalides"},{"location":"api/auth/#get-me","title":"GET /me","text":"<p>R\u00e9cup\u00e8re les informations de l'utilisateur connect\u00e9.</p> <p>Headers: <pre><code>Authorization: Bearer &lt;token&gt;\n</code></pre></p> <p>Response (200): <pre><code>{\n  \"id\": 1,\n  \"email\": \"user@example.com\",\n  \"name\": \"John Doe\",\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p> <p>Erreurs:</p> Code Description 401 Token invalide ou expir\u00e9"},{"location":"api/auth/#authentification-jwt","title":"Authentification JWT","text":""},{"location":"api/auth/#format-du-token","title":"Format du token","text":"<p>Les tokens JWT sont sign\u00e9s avec l'algorithme HS256 et contiennent :</p> <pre><code>{\n  \"sub\": \"user@example.com\",\n  \"exp\": 1705320000\n}\n</code></pre> <ul> <li><code>sub</code> : Email de l'utilisateur</li> <li><code>exp</code> : Timestamp d'expiration (7 jours par d\u00e9faut)</li> </ul>"},{"location":"api/auth/#utilisation","title":"Utilisation","text":"<p>Inclure le token dans le header <code>Authorization</code> :</p> <pre><code>curl -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIs...\" \\\n     http://localhost:8000/api/v1/auth/me\n</code></pre>"},{"location":"api/auth/#expiration","title":"Expiration","text":"<p>Les tokens expirent apr\u00e8s 7 jours (configurable via <code>ACCESS_TOKEN_EXPIRE_MINUTES</code>).</p> <p>Lorsqu'un token expire, l'API retourne une erreur 401 et le client doit redemander une authentification.</p>"},{"location":"api/budgets/","title":"API Budgets","text":"<p>Base URL: <code>/api/v1/budgets</code></p> <p>Les budgets permettent de d\u00e9finir des limites de d\u00e9penses mensuelles par cat\u00e9gorie (tag).</p>"},{"location":"api/budgets/#endpoints","title":"Endpoints","text":""},{"location":"api/budgets/#get","title":"GET /","text":"<p>Liste tous les budgets.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description month string Filtrer par mois (format: YYYY-MM) <p>Response (200): <pre><code>[\n  {\n    \"id\": 1,\n    \"tag_id\": 1,\n    \"month\": \"2024-01\",\n    \"limit_amount\": 500.00,\n    \"currency\": \"EUR\",\n    \"created_at\": \"2024-01-01T00:00:00Z\",\n    \"updated_at\": \"2024-01-01T00:00:00Z\",\n    \"tag\": {\n      \"id\": 1,\n      \"name\": \"Courses\",\n      \"color\": \"#22c55e\"\n    }\n  }\n]\n</code></pre></p>"},{"location":"api/budgets/#get-current","title":"GET /current","text":"<p>R\u00e9cup\u00e8re les budgets du mois avec les d\u00e9penses calcul\u00e9es.</p> <p>C'est l'endpoint principal pour le dashboard et la page budgets.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description month string Mois cible (format: YYYY-MM, d\u00e9faut: mois actuel) <p>Response (200): <pre><code>[\n  {\n    \"id\": 1,\n    \"tag_id\": 1,\n    \"tag_name\": \"Courses\",\n    \"tag_color\": \"#22c55e\",\n    \"month\": \"2024-01\",\n    \"limit_amount\": 500.00,\n    \"currency\": \"EUR\",\n    \"spent_amount\": 325.50,\n    \"remaining_amount\": 174.50,\n    \"percentage_used\": 65.1\n  },\n  {\n    \"id\": 2,\n    \"tag_id\": 2,\n    \"tag_name\": \"Transport\",\n    \"tag_color\": \"#3b82f6\",\n    \"month\": \"2024-01\",\n    \"limit_amount\": 150.00,\n    \"currency\": \"EUR\",\n    \"spent_amount\": 180.00,\n    \"remaining_amount\": -30.00,\n    \"percentage_used\": 120.0\n  }\n]\n</code></pre></p> <p>Calcul des d\u00e9penses</p> <p><code>spent_amount</code> est calcul\u00e9 en temps r\u00e9el \u00e0 partir des documents du mois ayant le tag correspondant.</p>"},{"location":"api/budgets/#post","title":"POST /","text":"<p>Cr\u00e9e un nouveau budget.</p> <p>Request Body: <pre><code>{\n  \"tag_id\": 1,\n  \"month\": \"2024-01\",\n  \"limit_amount\": 500.00,\n  \"currency\": \"EUR\"\n}\n</code></pre></p> Champ Type Obligatoire Description tag_id int Oui ID du tag associ\u00e9 month string Oui Mois (format: YYYY-MM) limit_amount number Oui Limite de d\u00e9penses currency string Non Devise (d\u00e9faut: EUR) <p>Response (201): <pre><code>{\n  \"id\": 1,\n  \"tag_id\": 1,\n  \"month\": \"2024-01\",\n  \"limit_amount\": 500.00,\n  \"currency\": \"EUR\",\n  \"created_at\": \"2024-01-01T00:00:00Z\",\n  \"updated_at\": \"2024-01-01T00:00:00Z\"\n}\n</code></pre></p> <p>Erreurs:</p> Code Description 400 Budget d\u00e9j\u00e0 existant pour ce tag/mois 404 Tag non trouv\u00e9"},{"location":"api/budgets/#put-id","title":"PUT /{id}","text":"<p>Met \u00e0 jour un budget.</p> <p>Request Body: <pre><code>{\n  \"limit_amount\": 600.00\n}\n</code></pre></p> Champ Type Description limit_amount number Nouvelle limite currency string Nouvelle devise <p>Response (200): Budget mis \u00e0 jour</p>"},{"location":"api/budgets/#delete-id","title":"DELETE /{id}","text":"<p>Supprime un budget.</p> <p>Response (204): No Content</p>"},{"location":"api/budgets/#indicateurs-visuels","title":"Indicateurs visuels","text":"<p>Le pourcentage d'utilisation d\u00e9termine la couleur de l'indicateur :</p> Pourcentage Couleur Signification 0-50% Vert (<code>#22c55e</code>) Confortable 50-75% Jaune (<code>#eab308</code>) \u00c0 surveiller 75-90% Orange (<code>#f97316</code>) Attention 90%+ Rouge (<code>#ef4444</code>) Limite proche/d\u00e9pass\u00e9e"},{"location":"api/budgets/#exemple-dutilisation","title":"Exemple d'utilisation","text":""},{"location":"api/budgets/#creer-des-budgets-pour-le-mois","title":"Cr\u00e9er des budgets pour le mois","text":"<pre><code>// Cr\u00e9er un budget courses\nawait budgets.create({\n  tag_id: 1, // ID du tag \"Courses\"\n  month: \"2024-01\",\n  limit_amount: 500\n});\n\n// Cr\u00e9er un budget transport\nawait budgets.create({\n  tag_id: 2, // ID du tag \"Transport\"\n  month: \"2024-01\",\n  limit_amount: 150\n});\n</code></pre>"},{"location":"api/budgets/#afficher-la-progression","title":"Afficher la progression","text":"<pre><code>const current = await budgets.getCurrent(\"2024-01\");\n\ncurrent.forEach(budget =&gt; {\n  console.log(`${budget.tag_name}: ${budget.percentage_used}%`);\n  if (budget.percentage_used &gt; 100) {\n    console.log(\"\u26a0\ufe0f Budget d\u00e9pass\u00e9 !\");\n  }\n});\n</code></pre>"},{"location":"api/documents/","title":"API Documents","text":"<p>Base URL: <code>/api/v1/documents</code></p> <p>Tous les endpoints n\u00e9cessitent une authentification (header <code>Authorization: Bearer &lt;token&gt;</code>).</p>"},{"location":"api/documents/#endpoints","title":"Endpoints","text":""},{"location":"api/documents/#get","title":"GET /","text":"<p>Liste les documents de l'utilisateur connect\u00e9.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description skip int Offset pour pagination (d\u00e9faut: 0) limit int Nombre max de r\u00e9sultats (d\u00e9faut: 100) start_date date Filtrer \u00e0 partir de cette date end_date date Filtrer jusqu'\u00e0 cette date tag_id int Filtrer par tag is_income bool Filtrer revenus/d\u00e9penses doc_type string Filtrer par type (receipt, invoice...) <p>Response (200): <pre><code>[\n  {\n    \"id\": 1,\n    \"original_name\": \"ticket-carrefour.jpg\",\n    \"doc_type\": \"receipt\",\n    \"date\": \"2024-01-15\",\n    \"merchant\": \"Carrefour\",\n    \"total_amount\": 45.67,\n    \"currency\": \"EUR\",\n    \"is_income\": false,\n    \"created_at\": \"2024-01-15T10:30:00Z\",\n    \"tags\": [\n      {\"id\": 1, \"name\": \"Courses\", \"color\": \"#22c55e\"}\n    ]\n  }\n]\n</code></pre></p>"},{"location":"api/documents/#post-upload","title":"POST /upload","text":"<p>Upload un nouveau document (image ou PDF).</p> <p>Content-Type: <code>multipart/form-data</code></p> <p>Form Data:</p> Champ Type Description file File Fichier \u00e0 uploader (obligatoire) <p>Formats accept\u00e9s: JPG, JPEG, PNG, WEBP, BMP, PDF</p> <p>Taille max: 50 Mo</p> <p>Response (201): <pre><code>{\n  \"id\": 1,\n  \"file_path\": \"/app/uploads/2024-01-15_abc123_ticket.jpg\",\n  \"original_name\": \"ticket-carrefour.jpg\",\n  \"file_type\": \"image/jpeg\",\n  \"doc_type\": \"receipt\",\n  \"date\": \"2024-01-15\",\n  \"time\": \"14:30:00\",\n  \"merchant\": \"Carrefour\",\n  \"location\": \"Paris 15e\",\n  \"total_amount\": 45.67,\n  \"currency\": \"EUR\",\n  \"is_income\": false,\n  \"ocr_raw_text\": \"CARREFOUR\\n...\",\n  \"ocr_confidence\": 92.5,\n  \"synced_to_nas\": false,\n  \"tags\": [],\n  \"items\": [\n    {\n      \"id\": 1,\n      \"name\": \"Pommes Golden\",\n      \"quantity\": 1.5,\n      \"unit\": \"kg\",\n      \"unit_price\": 2.99,\n      \"total_price\": 4.49,\n      \"category\": \"Fruits\"\n    }\n  ]\n}\n</code></pre></p> <p>Traitement automatique</p> <p>L'upload d\u00e9clenche automatiquement : 1. OCR (extraction du texte) 2. IA (analyse et extraction des donn\u00e9es) 3. Cr\u00e9ation des items (articles)</p>"},{"location":"api/documents/#get-id","title":"GET /{id}","text":"<p>R\u00e9cup\u00e8re le d\u00e9tail d'un document.</p> <p>Response (200): <pre><code>{\n  \"id\": 1,\n  \"file_path\": \"/app/uploads/2024-01-15_abc123_ticket.jpg\",\n  \"original_name\": \"ticket-carrefour.jpg\",\n  \"doc_type\": \"receipt\",\n  \"date\": \"2024-01-15\",\n  \"merchant\": \"Carrefour\",\n  \"total_amount\": 45.67,\n  \"currency\": \"EUR\",\n  \"is_income\": false,\n  \"ocr_raw_text\": \"CARREFOUR\\nParis 15e...\",\n  \"tags\": [...],\n  \"items\": [...]\n}\n</code></pre></p> <p>Erreurs:</p> Code Description 404 Document non trouv\u00e9"},{"location":"api/documents/#put-id","title":"PUT /{id}","text":"<p>Met \u00e0 jour un document.</p> <p>Request Body: <pre><code>{\n  \"doc_type\": \"invoice\",\n  \"date\": \"2024-01-15\",\n  \"merchant\": \"EDF\",\n  \"total_amount\": 120.50,\n  \"currency\": \"EUR\",\n  \"is_income\": false\n}\n</code></pre></p> <p>Tous les champs sont optionnels.</p> <p>Response (200): Document mis \u00e0 jour</p>"},{"location":"api/documents/#delete-id","title":"DELETE /{id}","text":"<p>Supprime un document et ses items associ\u00e9s.</p> <p>Response (204): No Content</p>"},{"location":"api/documents/#post-idreprocess","title":"POST /{id}/reprocess","text":"<p>Relance l'extraction OCR/IA sur un document existant.</p> <p>Utile si l'extraction initiale a \u00e9chou\u00e9 ou pour r\u00e9analyser apr\u00e8s mise \u00e0 jour du mod\u00e8le IA.</p> <p>Response (200): Document avec nouvelles donn\u00e9es extraites</p>"},{"location":"api/documents/#post-idtagstag_id","title":"POST /{id}/tags/{tag_id}","text":"<p>Ajoute un tag \u00e0 un document.</p> <p>Response (200): Document avec le tag ajout\u00e9</p> <p>Erreurs:</p> Code Description 404 Document ou tag non trouv\u00e9 400 Tag d\u00e9j\u00e0 associ\u00e9"},{"location":"api/documents/#delete-idtagstag_id","title":"DELETE /{id}/tags/{tag_id}","text":"<p>Retire un tag d'un document.</p> <p>Response (200): Document sans le tag</p>"},{"location":"api/documents/#exemple-dupload-avec-curl","title":"Exemple d'upload avec cURL","text":"<pre><code>curl -X POST \"http://localhost:8000/api/v1/documents/upload\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -F \"file=@/path/to/ticket.jpg\"\n</code></pre>"},{"location":"api/documents/#exemple-dupload-avec-javascript","title":"Exemple d'upload avec JavaScript","text":"<pre><code>const formData = new FormData();\nformData.append('file', fileInput.files[0]);\n\nconst response = await fetch('/api/v1/documents/upload', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${token}`\n  },\n  body: formData\n});\n\nconst document = await response.json();\n</code></pre>"},{"location":"api/export/","title":"API Export","text":"<p>Base URL: <code>/api/v1/export</code></p> <p>Endpoints pour exporter les donn\u00e9es en format CSV.</p>"},{"location":"api/export/#endpoints","title":"Endpoints","text":""},{"location":"api/export/#get-documentscsv","title":"GET /documents/csv","text":"<p>Exporte les documents en format CSV.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description start_date date Date de d\u00e9but (format: YYYY-MM-DD) end_date date Date de fin (format: YYYY-MM-DD) tag_ids int[] Filtrer par tags (peut \u00eatre r\u00e9p\u00e9t\u00e9) include_items bool Inclure le d\u00e9tail des articles (d\u00e9faut: false) <p>Response (200): - Content-Type: <code>text/csv; charset=utf-8</code> - Content-Disposition: <code>attachment; filename=\"documents_*.csv\"</code></p>"},{"location":"api/export/#format-sans-items-defaut","title":"Format sans items (d\u00e9faut)","text":"<p>Une ligne par document :</p> <pre><code>ID;Date;Heure;Marchand;Lieu;Type;Montant;Devise;Type transaction;Tags;Fichier original\n1;2024-01-15;14:30:00;Carrefour;Paris 15e;receipt;45.67;EUR;D\u00e9pense;Courses;ticket-carrefour.jpg\n2;2024-01-16;09:15:00;RATP;Paris;receipt;16.90;EUR;D\u00e9pense;Transport;navigo.pdf\n</code></pre>"},{"location":"api/export/#format-avec-items","title":"Format avec items","text":"<p>Une ligne par article :</p> <pre><code>ID Document;Date;Marchand;Article;Quantit\u00e9;Unit\u00e9;Prix unitaire;Prix total;Cat\u00e9gorie article;Tags document\n1;2024-01-15;Carrefour;Pommes Golden;1.50;kg;2.99;4.49;Fruits;Courses\n1;2024-01-15;Carrefour;Baguette;2.00;;1.20;2.40;Boulangerie;Courses\n1;2024-01-15;Carrefour;Lait;1.00;L;1.10;1.10;Produits laitiers;Courses\n</code></pre>"},{"location":"api/export/#get-monthlycsv","title":"GET /monthly/csv","text":"<p>Exporte le r\u00e9sum\u00e9 mensuel en format CSV.</p> <p>Query Parameters:</p> Param\u00e8tre Type Obligatoire Description year int Oui Ann\u00e9e (2000-2100) month int Oui Mois (1-12) <p>Response (200): - Content-Type: <code>text/csv; charset=utf-8</code> - Content-Disposition: <code>attachment; filename=\"resume_YYYY-MM.csv\"</code></p> <p>Format:</p> <pre><code>R\u00e9sum\u00e9 mensuel;2024-01\n\nM\u00e9trique;Valeur\nTotal d\u00e9penses;1250.75 EUR\nTotal revenus;3500.00 EUR\nSolde;2249.25 EUR\nNombre de transactions;42\n\nD\u00e9penses par cat\u00e9gorie\nTag;Montant;Pourcentage\nCourses;450.30 EUR;36.0%\nTransport;180.00 EUR;14.4%\nLogement;400.00 EUR;32.0%\nLoisirs;220.45 EUR;17.6%\n</code></pre>"},{"location":"api/export/#exemples-dutilisation","title":"Exemples d'utilisation","text":""},{"location":"api/export/#export-avec-curl","title":"Export avec cURL","text":"<pre><code># Export basique\ncurl -H \"Authorization: Bearer $TOKEN\" \\\n     \"http://localhost:8000/api/v1/export/documents/csv\" \\\n     -o documents.csv\n\n# Export avec filtres\ncurl -H \"Authorization: Bearer $TOKEN\" \\\n     \"http://localhost:8000/api/v1/export/documents/csv?start_date=2024-01-01&amp;end_date=2024-01-31&amp;tag_ids=1&amp;tag_ids=2\" \\\n     -o janvier.csv\n\n# Export avec d\u00e9tail des articles\ncurl -H \"Authorization: Bearer $TOKEN\" \\\n     \"http://localhost:8000/api/v1/export/documents/csv?include_items=true\" \\\n     -o documents_details.csv\n\n# Export r\u00e9sum\u00e9 mensuel\ncurl -H \"Authorization: Bearer $TOKEN\" \\\n     \"http://localhost:8000/api/v1/export/monthly/csv?year=2024&amp;month=1\" \\\n     -o resume_janvier.csv\n</code></pre>"},{"location":"api/export/#export-avec-javascript","title":"Export avec JavaScript","text":"<pre><code>// T\u00e9l\u00e9charger l'export documents\nawait exportApi.documentsCSV({\n  start_date: \"2024-01-01\",\n  end_date: \"2024-01-31\",\n  tag_ids: [1, 2],\n  include_items: true\n});\n// Le fichier est t\u00e9l\u00e9charg\u00e9 automatiquement\n\n// T\u00e9l\u00e9charger le r\u00e9sum\u00e9 mensuel\nawait exportApi.monthlyCSV(2024, 1);\n</code></pre>"},{"location":"api/export/#notes","title":"Notes","text":"<p>S\u00e9parateur</p> <p>Le s\u00e9parateur utilis\u00e9 est le point-virgule (<code>;</code>) pour une meilleure compatibilit\u00e9 avec Excel en version fran\u00e7aise.</p> <p>Encodage</p> <p>Les fichiers sont encod\u00e9s en UTF-8 avec BOM pour garantir l'affichage correct des caract\u00e8res accentu\u00e9s dans Excel.</p>"},{"location":"api/stats/","title":"API Statistiques","text":"<p>Base URL: <code>/api/v1/stats</code></p> <p>Endpoints pour r\u00e9cup\u00e9rer les statistiques et donn\u00e9es du dashboard.</p>"},{"location":"api/stats/#endpoints","title":"Endpoints","text":""},{"location":"api/stats/#get-summary","title":"GET /summary","text":"<p>R\u00e9cup\u00e8re le r\u00e9sum\u00e9 financier d'un mois.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description month string Mois cible (format: YYYY-MM, d\u00e9faut: mois actuel) <p>Response (200): <pre><code>{\n  \"month\": \"2024-01\",\n  \"total_expenses\": 1250.75,\n  \"total_income\": 3500.00,\n  \"balance\": 2249.25,\n  \"transaction_count\": 42\n}\n</code></pre></p> Champ Description total_expenses Somme des documents o\u00f9 is_income=false total_income Somme des documents o\u00f9 is_income=true balance total_income - total_expenses transaction_count Nombre total de documents"},{"location":"api/stats/#get-by-tag","title":"GET /by-tag","text":"<p>R\u00e9cup\u00e8re les d\u00e9penses group\u00e9es par tag.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description month string Mois cible (format: YYYY-MM, d\u00e9faut: mois actuel) <p>Response (200): <pre><code>[\n  {\n    \"tag_id\": 1,\n    \"tag_name\": \"Courses\",\n    \"tag_color\": \"#22c55e\",\n    \"total_amount\": 450.30,\n    \"transaction_count\": 12,\n    \"percentage\": 36.0\n  },\n  {\n    \"tag_id\": 2,\n    \"tag_name\": \"Transport\",\n    \"tag_color\": \"#3b82f6\",\n    \"total_amount\": 180.00,\n    \"transaction_count\": 8,\n    \"percentage\": 14.4\n  },\n  {\n    \"tag_id\": null,\n    \"tag_name\": \"Non cat\u00e9goris\u00e9\",\n    \"tag_color\": \"#9ca3af\",\n    \"total_amount\": 620.45,\n    \"transaction_count\": 22,\n    \"percentage\": 49.6\n  }\n]\n</code></pre></p> <p>Documents sans tag</p> <p>Les documents sans tag sont regroup\u00e9s sous \"Non cat\u00e9goris\u00e9\" avec <code>tag_id: null</code>.</p>"},{"location":"api/stats/#get-monthly","title":"GET /monthly","text":"<p>R\u00e9cup\u00e8re l'\u00e9volution des d\u00e9penses/revenus sur plusieurs mois.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description months int Nombre de mois \u00e0 r\u00e9cup\u00e9rer (d\u00e9faut: 12, max: 24) <p>Response (200): <pre><code>[\n  {\n    \"month\": \"2023-02\",\n    \"expenses\": 1100.50,\n    \"income\": 3200.00\n  },\n  {\n    \"month\": \"2023-03\",\n    \"expenses\": 1350.25,\n    \"income\": 3200.00\n  },\n  {\n    \"month\": \"2024-01\",\n    \"expenses\": 1250.75,\n    \"income\": 3500.00\n  }\n]\n</code></pre></p> <p>Les donn\u00e9es sont tri\u00e9es par mois croissant.</p>"},{"location":"api/stats/#get-top-items","title":"GET /top-items","text":"<p>R\u00e9cup\u00e8re les articles les plus fr\u00e9quemment achet\u00e9s.</p> <p>Query Parameters:</p> Param\u00e8tre Type Description month string Mois cible (optionnel, tous les mois si omis) limit int Nombre max de r\u00e9sultats (d\u00e9faut: 10) <p>Response (200): <pre><code>[\n  {\n    \"name\": \"Pommes Golden\",\n    \"total_quantity\": 15.5,\n    \"total_spent\": 46.35,\n    \"purchase_count\": 8\n  },\n  {\n    \"name\": \"Baguette tradition\",\n    \"total_quantity\": 24.0,\n    \"total_spent\": 28.80,\n    \"purchase_count\": 24\n  },\n  {\n    \"name\": \"Lait demi-\u00e9cr\u00e9m\u00e9\",\n    \"total_quantity\": 12.0,\n    \"total_spent\": 13.20,\n    \"purchase_count\": 12\n  }\n]\n</code></pre></p> Champ Description name Nom de l'article total_quantity Quantit\u00e9 totale achet\u00e9e total_spent Montant total d\u00e9pens\u00e9 purchase_count Nombre de fois achet\u00e9"},{"location":"api/stats/#exemple-dutilisation-pour-le-dashboard","title":"Exemple d'utilisation pour le dashboard","text":"<pre><code>// Charger toutes les donn\u00e9es du dashboard en parall\u00e8le\nconst [summary, byTag, monthly, topItems, budgets] = await Promise.all([\n  stats.getSummary(\"2024-01\"),\n  stats.getByTag(\"2024-01\"),\n  stats.getMonthly(12),\n  stats.getTopItems({ month: \"2024-01\", limit: 5 }),\n  budgets.getCurrent(\"2024-01\")\n]);\n\n// Afficher le r\u00e9sum\u00e9\nconsole.log(`Solde: ${summary.balance}\u20ac`);\n\n// Graphique camembert par tag\nbyTag.forEach(tag =&gt; {\n  console.log(`${tag.tag_name}: ${tag.percentage}%`);\n});\n\n// Graphique d'\u00e9volution\nmonthly.forEach(month =&gt; {\n  console.log(`${month.month}: +${month.income}\u20ac / -${month.expenses}\u20ac`);\n});\n</code></pre>"},{"location":"api/sync/","title":"API Synchronisation","text":"<p>Base URL: <code>/api/v1/sync</code></p> <p>Endpoints pour la synchronisation des fichiers vers le NAS.</p>"},{"location":"api/sync/#prerequis","title":"Pr\u00e9requis","text":"<p>La synchronisation n\u00e9cessite une configuration pr\u00e9alable dans le fichier <code>.env</code> :</p> <pre><code>NAS_HOST=192.168.1.100    # IP ou hostname du NAS\nNAS_USER=your-user         # Utilisateur SSH\nNAS_PATH=/volume1/factures # Chemin de destination\n</code></pre> <p>Une cl\u00e9 SSH doit \u00eatre configur\u00e9e pour l'authentification sans mot de passe.</p>"},{"location":"api/sync/#endpoints","title":"Endpoints","text":""},{"location":"api/sync/#get-status","title":"GET /status","text":"<p>R\u00e9cup\u00e8re les statistiques de synchronisation.</p> <p>Response (200): <pre><code>{\n  \"total_documents\": 150,\n  \"synced\": 142,\n  \"pending\": 8,\n  \"sync_percentage\": 94.7,\n  \"last_sync\": \"2024-01-15T14:30:00Z\",\n  \"nas_configured\": true\n}\n</code></pre></p> Champ Description total_documents Nombre total de documents synced Documents synchronis\u00e9s pending Documents en attente de sync sync_percentage Pourcentage de synchronisation last_sync Date de derni\u00e8re synchronisation nas_configured Configuration NAS compl\u00e8te"},{"location":"api/sync/#get-config","title":"GET /config","text":"<p>R\u00e9cup\u00e8re le statut de la configuration NAS.</p> <p>Response (200): <pre><code>{\n  \"configured\": true,\n  \"nas_host\": true,\n  \"nas_user\": true,\n  \"nas_path\": true,\n  \"host\": \"192.168.1.100\",\n  \"path\": \"/volume1/factures\"\n}\n</code></pre></p> <p>Mot de passe masqu\u00e9</p> <p>Le mot de passe/cl\u00e9 SSH n'est jamais retourn\u00e9 pour des raisons de s\u00e9curit\u00e9.</p>"},{"location":"api/sync/#post-test","title":"POST /test","text":"<p>Teste la connexion SSH vers le NAS.</p> <p>Response (200): <pre><code>{\n  \"success\": true,\n  \"message\": \"Connexion r\u00e9ussie\"\n}\n</code></pre></p> <p>Erreurs possibles:</p> <pre><code>{\n  \"success\": false,\n  \"message\": \"Synchronisation NAS non configur\u00e9e. D\u00e9finissez NAS_HOST, NAS_USER et NAS_PATH dans le fichier .env\"\n}\n</code></pre> <pre><code>{\n  \"success\": false,\n  \"message\": \"\u00c9chec de connexion : Permission denied (publickey)\"\n}\n</code></pre> <pre><code>{\n  \"success\": false,\n  \"message\": \"Timeout de connexion (15s)\"\n}\n</code></pre>"},{"location":"api/sync/#post-run","title":"POST /run","text":"<p>Lance la synchronisation de tous les documents en attente.</p> <p>Dur\u00e9e</p> <p>Cette op\u00e9ration peut prendre du temps selon le nombre de fichiers \u00e0 synchroniser.</p> <p>Response (200): <pre><code>{\n  \"total\": 8,\n  \"synced\": 7,\n  \"failed\": 1,\n  \"errors\": [\n    \"Document 42: Fichier source introuvable\"\n  ]\n}\n</code></pre></p> Champ Description total Nombre de documents \u00e0 synchroniser synced Documents synchronis\u00e9s avec succ\u00e8s failed Documents en \u00e9chec errors Liste des erreurs d\u00e9taill\u00e9es <p>Erreurs:</p> Code Description 400 NAS non configur\u00e9"},{"location":"api/sync/#post-documentdocument_id","title":"POST /document/{document_id}","text":"<p>Synchronise un document sp\u00e9cifique.</p> <p>Path Parameters:</p> Param\u00e8tre Type Description document_id int ID du document <p>Response (200): <pre><code>{\n  \"success\": true,\n  \"message\": \"Synchronis\u00e9 vers 192.168.1.100\"\n}\n</code></pre></p> <p>Erreurs:</p> Code Description 400 NAS non configur\u00e9 404 Document non trouv\u00e9"},{"location":"api/sync/#fonctionnement-technique","title":"Fonctionnement technique","text":""},{"location":"api/sync/#rsync","title":"rsync","text":"<p>La synchronisation utilise <code>rsync</code> via SSH :</p> <pre><code>rsync -avz --progress \\\n  -e \"ssh -o BatchMode=yes -o ConnectTimeout=30\" \\\n  /app/uploads/document.jpg \\\n  user@nas:/volume1/factures/document.jpg\n</code></pre> <p>Options utilis\u00e9es : - <code>-a</code> : Mode archive (pr\u00e9serve permissions, dates...) - <code>-v</code> : Verbose - <code>-z</code> : Compression pendant le transfert - <code>--progress</code> : Affiche la progression</p>"},{"location":"api/sync/#marquage-en-base","title":"Marquage en base","text":"<p>Apr\u00e8s synchronisation r\u00e9ussie, le document est mis \u00e0 jour :</p> <pre><code>UPDATE documents SET\n  synced_to_nas = TRUE,\n  synced_at = NOW()\nWHERE id = ?;\n</code></pre>"},{"location":"api/sync/#exemple-dutilisation","title":"Exemple d'utilisation","text":"<pre><code>// V\u00e9rifier la configuration\nconst config = await sync.getConfig();\nif (!config.configured) {\n  console.log(\"NAS non configur\u00e9\");\n  return;\n}\n\n// Tester la connexion\nconst test = await sync.testConnection();\nif (!test.success) {\n  console.error(\"\u00c9chec:\", test.message);\n  return;\n}\n\n// Voir le statut\nconst status = await sync.getStatus();\nconsole.log(`${status.pending} documents en attente`);\n\n// Lancer la synchronisation\nif (status.pending &gt; 0) {\n  const result = await sync.runSync();\n  console.log(`${result.synced} synchronis\u00e9s, ${result.failed} \u00e9checs`);\n}\n</code></pre>"},{"location":"api/tags/","title":"API Tags","text":"<p>Base URL: <code>/api/v1/tags</code></p> <p>Les tags permettent de cat\u00e9goriser les documents de mani\u00e8re flexible.</p>"},{"location":"api/tags/#endpoints","title":"Endpoints","text":""},{"location":"api/tags/#get","title":"GET /","text":"<p>Liste tous les tags de l'utilisateur.</p> <p>Response (200): <pre><code>[\n  {\n    \"id\": 1,\n    \"name\": \"Courses\",\n    \"color\": \"#22c55e\",\n    \"icon\": \"shopping-cart\",\n    \"created_at\": \"2024-01-15T10:30:00Z\"\n  },\n  {\n    \"id\": 2,\n    \"name\": \"Transport\",\n    \"color\": \"#3b82f6\",\n    \"icon\": \"car\",\n    \"created_at\": \"2024-01-15T10:31:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"api/tags/#post","title":"POST /","text":"<p>Cr\u00e9e un nouveau tag.</p> <p>Request Body: <pre><code>{\n  \"name\": \"Loisirs\",\n  \"color\": \"#f59e0b\",\n  \"icon\": \"gamepad\"\n}\n</code></pre></p> Champ Type Obligatoire Description name string Oui Nom du tag (unique par utilisateur) color string Oui Couleur hexad\u00e9cimale (#RRGGBB) icon string Non Nom de l'ic\u00f4ne (optionnel) <p>Response (201): <pre><code>{\n  \"id\": 3,\n  \"name\": \"Loisirs\",\n  \"color\": \"#f59e0b\",\n  \"icon\": \"gamepad\",\n  \"created_at\": \"2024-01-15T11:00:00Z\"\n}\n</code></pre></p> <p>Erreurs:</p> Code Description 400 Nom de tag d\u00e9j\u00e0 utilis\u00e9 422 Donn\u00e9es invalides"},{"location":"api/tags/#get-id","title":"GET /{id}","text":"<p>R\u00e9cup\u00e8re un tag par son ID.</p> <p>Response (200): <pre><code>{\n  \"id\": 1,\n  \"name\": \"Courses\",\n  \"color\": \"#22c55e\",\n  \"icon\": \"shopping-cart\",\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p>"},{"location":"api/tags/#put-id","title":"PUT /{id}","text":"<p>Met \u00e0 jour un tag.</p> <p>Request Body: <pre><code>{\n  \"name\": \"Alimentation\",\n  \"color\": \"#16a34a\"\n}\n</code></pre></p> <p>Tous les champs sont optionnels.</p> <p>Response (200): Tag mis \u00e0 jour</p>"},{"location":"api/tags/#delete-id","title":"DELETE /{id}","text":"<p>Supprime un tag.</p> <p>Attention</p> <p>La suppression d'un tag le retire de tous les documents associ\u00e9s. Les budgets li\u00e9s \u00e0 ce tag sont \u00e9galement supprim\u00e9s.</p> <p>Response (204): No Content</p>"},{"location":"api/tags/#couleurs-suggerees","title":"Couleurs sugg\u00e9r\u00e9es","text":"Cat\u00e9gorie Couleur Hex Courses Vert <code>#22c55e</code> Transport Bleu <code>#3b82f6</code> Logement Violet <code>#8b5cf6</code> Loisirs Orange <code>#f59e0b</code> Sant\u00e9 Rose <code>#ec4899</code> Restaurant Rouge <code>#ef4444</code> Voyage Cyan <code>#06b6d4</code> Revenus \u00c9meraude <code>#10b981</code>"},{"location":"api/tags/#icones-suggerees","title":"Ic\u00f4nes sugg\u00e9r\u00e9es","text":"<p>Les ic\u00f4nes sont optionnelles et utilisent les noms de Lucide Icons.</p> Cat\u00e9gorie Ic\u00f4ne Courses <code>shopping-cart</code> Transport <code>car</code> Logement <code>home</code> Loisirs <code>gamepad</code> Sant\u00e9 <code>heart-pulse</code> Restaurant <code>utensils</code> Voyage <code>plane</code> Salaire <code>banknote</code>"},{"location":"architecture/backend/","title":"Architecture Backend","text":""},{"location":"architecture/backend/#structure-des-dossiers","title":"Structure des dossiers","text":"<pre><code>backend/\n\u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 main.py              # Point d'entr\u00e9e FastAPI\n\u2502   \u251c\u2500\u2500 core/                # Configuration centrale\n\u2502   \u2502   \u251c\u2500\u2500 config.py        # Variables d'environnement\n\u2502   \u2502   \u251c\u2500\u2500 database.py      # Connexion PostgreSQL\n\u2502   \u2502   \u2514\u2500\u2500 security.py      # JWT, bcrypt\n\u2502   \u251c\u2500\u2500 models/              # Mod\u00e8les SQLAlchemy\n\u2502   \u2502   \u251c\u2500\u2500 user.py\n\u2502   \u2502   \u251c\u2500\u2500 document.py\n\u2502   \u2502   \u251c\u2500\u2500 item.py\n\u2502   \u2502   \u251c\u2500\u2500 tag.py\n\u2502   \u2502   \u251c\u2500\u2500 budget.py\n\u2502   \u2502   \u2514\u2500\u2500 currency.py\n\u2502   \u251c\u2500\u2500 schemas/             # Sch\u00e9mas Pydantic\n\u2502   \u2502   \u251c\u2500\u2500 user.py\n\u2502   \u2502   \u251c\u2500\u2500 document.py\n\u2502   \u2502   \u251c\u2500\u2500 item.py\n\u2502   \u2502   \u251c\u2500\u2500 tag.py\n\u2502   \u2502   \u251c\u2500\u2500 budget.py\n\u2502   \u2502   \u2514\u2500\u2500 currency.py\n\u2502   \u251c\u2500\u2500 api/\n\u2502   \u2502   \u251c\u2500\u2500 deps.py          # D\u00e9pendances (get_db, get_current_user)\n\u2502   \u2502   \u2514\u2500\u2500 routes/          # Endpoints API\n\u2502   \u2502       \u251c\u2500\u2500 auth.py\n\u2502   \u2502       \u251c\u2500\u2500 documents.py\n\u2502   \u2502       \u251c\u2500\u2500 tags.py\n\u2502   \u2502       \u251c\u2500\u2500 budgets.py\n\u2502   \u2502       \u251c\u2500\u2500 items.py\n\u2502   \u2502       \u251c\u2500\u2500 stats.py\n\u2502   \u2502       \u251c\u2500\u2500 currencies.py\n\u2502   \u2502       \u251c\u2500\u2500 export.py\n\u2502   \u2502       \u2514\u2500\u2500 sync.py\n\u2502   \u2514\u2500\u2500 services/            # Logique m\u00e9tier\n\u2502       \u251c\u2500\u2500 ocr_service.py\n\u2502       \u251c\u2500\u2500 ai_service.py\n\u2502       \u251c\u2500\u2500 document_processor.py\n\u2502       \u251c\u2500\u2500 export_service.py\n\u2502       \u251c\u2500\u2500 nas_sync_service.py\n\u2502       \u2514\u2500\u2500 currency_service.py\n\u251c\u2500\u2500 alembic/                 # Migrations BDD\n\u2502   \u2514\u2500\u2500 versions/\n\u2502       \u2514\u2500\u2500 001_initial_schema.py\n\u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500 requirements.txt\n</code></pre>"},{"location":"architecture/backend/#modeles-de-donnees","title":"Mod\u00e8les de donn\u00e9es","text":""},{"location":"architecture/backend/#user","title":"User","text":"<pre><code>class User(Base):\n    id: int                  # Cl\u00e9 primaire\n    email: str               # Email unique\n    password_hash: str       # Mot de passe hash\u00e9 (bcrypt)\n    name: str | None         # Nom affich\u00e9\n    created_at: datetime     # Date de cr\u00e9ation\n</code></pre>"},{"location":"architecture/backend/#document","title":"Document","text":"<pre><code>class Document(Base):\n    id: int\n    user_id: int             # Propri\u00e9taire\n\n    # Fichier\n    file_path: str           # Chemin sur le serveur\n    original_name: str       # Nom original\n    file_type: str           # MIME type\n\n    # Extraction\n    doc_type: str            # receipt, invoice, payslip, other\n    date: date\n    time: time\n    merchant: str\n    location: str\n\n    # Finances\n    total_amount: Decimal\n    currency: str            # Code ISO (EUR, USD...)\n    is_income: bool\n\n    # OCR\n    ocr_raw_text: str        # Texte brut extrait\n    ocr_confidence: Decimal  # Score de confiance (0-100)\n\n    # Sync\n    synced_to_nas: bool\n    synced_at: datetime\n\n    # Relations\n    items: List[Item]\n    tags: List[Tag]\n</code></pre>"},{"location":"architecture/backend/#item-articles","title":"Item (Articles)","text":"<pre><code>class Item(Base):\n    id: int\n    document_id: int\n\n    name: str                # Nom de l'article\n    quantity: Decimal        # Quantit\u00e9\n    unit: str                # Unit\u00e9 (kg, L, pi\u00e8ce...)\n    unit_price: Decimal      # Prix unitaire\n    total_price: Decimal     # Prix total\n    category: str            # Cat\u00e9gorie de l'article\n</code></pre>"},{"location":"architecture/backend/#services","title":"Services","text":""},{"location":"architecture/backend/#ocrservice","title":"OCRService","text":"<p>Extraction de texte depuis images et PDFs.</p> <pre><code>class OCRService:\n    def extract_text(self, file_path: str) -&gt; OCRResult:\n        \"\"\"\n        Extrait le texte d'un fichier image ou PDF.\n\n        Retourne:\n            OCRResult avec texte brut et score de confiance\n        \"\"\"\n</code></pre> <p>Formats support\u00e9s : - Images : JPG, JPEG, PNG, WEBP, BMP - Documents : PDF (converti en images)</p>"},{"location":"architecture/backend/#aiservice","title":"AIService","text":"<p>Analyse du texte et extraction structur\u00e9e.</p> <pre><code>class AIService:\n    async def extract_structured_data(self, raw_text: str) -&gt; ExtractionResult:\n        \"\"\"\n        Analyse le texte OCR et extrait les donn\u00e9es structur\u00e9es.\n\n        Utilise Ollama/Mistral pour l'analyse.\n\n        Retourne:\n            ExtractionResult avec toutes les informations extraites\n        \"\"\"\n</code></pre>"},{"location":"architecture/backend/#documentprocessor","title":"DocumentProcessor","text":"<p>Pipeline complet de traitement.</p> <pre><code>class DocumentProcessor:\n    async def process(self, document_id: int) -&gt; Document:\n        \"\"\"\n        Pipeline complet:\n        1. OCR \u2192 Extraction texte\n        2. IA \u2192 Analyse et structuration\n        3. BDD \u2192 Mise \u00e0 jour Document + Items\n        \"\"\"\n</code></pre>"},{"location":"architecture/backend/#routes-api","title":"Routes API","text":""},{"location":"architecture/backend/#authentification-auth","title":"Authentification (<code>/auth</code>)","text":"M\u00e9thode Endpoint Description POST <code>/register</code> Cr\u00e9er un compte POST <code>/login</code> Se connecter GET <code>/me</code> Infos utilisateur"},{"location":"architecture/backend/#documents-documents","title":"Documents (<code>/documents</code>)","text":"M\u00e9thode Endpoint Description GET <code>/</code> Liste documents POST <code>/upload</code> Upload fichier GET <code>/{id}</code> D\u00e9tail document PUT <code>/{id}</code> Modifier document DELETE <code>/{id}</code> Supprimer document POST <code>/{id}/reprocess</code> Relancer OCR/IA POST <code>/{id}/tags/{tag_id}</code> Ajouter tag DELETE <code>/{id}/tags/{tag_id}</code> Retirer tag"},{"location":"architecture/backend/#tags-tags","title":"Tags (<code>/tags</code>)","text":"M\u00e9thode Endpoint Description GET <code>/</code> Liste tags POST <code>/</code> Cr\u00e9er tag GET <code>/{id}</code> D\u00e9tail tag PUT <code>/{id}</code> Modifier tag DELETE <code>/{id}</code> Supprimer tag"},{"location":"architecture/backend/#budgets-budgets","title":"Budgets (<code>/budgets</code>)","text":"M\u00e9thode Endpoint Description GET <code>/</code> Liste budgets GET <code>/current</code> Budgets du mois avec d\u00e9penses POST <code>/</code> Cr\u00e9er budget PUT <code>/{id}</code> Modifier budget DELETE <code>/{id}</code> Supprimer budget"},{"location":"architecture/backend/#statistiques-stats","title":"Statistiques (<code>/stats</code>)","text":"M\u00e9thode Endpoint Description GET <code>/summary</code> R\u00e9sum\u00e9 du mois GET <code>/by-tag</code> D\u00e9penses par tag GET <code>/monthly</code> \u00c9volution mensuelle GET <code>/top-items</code> Articles fr\u00e9quents"},{"location":"architecture/backend/#export-export","title":"Export (<code>/export</code>)","text":"M\u00e9thode Endpoint Description GET <code>/documents/csv</code> Export CSV documents GET <code>/monthly/csv</code> Export r\u00e9sum\u00e9 mensuel"},{"location":"architecture/backend/#synchronisation-sync","title":"Synchronisation (<code>/sync</code>)","text":"M\u00e9thode Endpoint Description GET <code>/status</code> Statut synchronisation GET <code>/config</code> Config NAS POST <code>/test</code> Tester connexion POST <code>/run</code> Lancer sync POST <code>/document/{id}</code> Sync un document"},{"location":"architecture/backend/#dependances","title":"D\u00e9pendances","text":"<pre><code># Injection de la session BDD\ndef get_db() -&gt; Generator[Session, None, None]:\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n\n# R\u00e9cup\u00e9ration de l'utilisateur depuis le token JWT\ndef get_current_user(\n    token: str = Depends(oauth2_scheme),\n    db: Session = Depends(get_db)\n) -&gt; User:\n    # D\u00e9code le token\n    # R\u00e9cup\u00e8re l'utilisateur\n    # Retourne ou l\u00e8ve 401\n</code></pre>"},{"location":"architecture/frontend/","title":"Architecture Frontend","text":""},{"location":"architecture/frontend/#stack-technique","title":"Stack technique","text":"Technologie Version Usage React 18.2 UI Framework TypeScript 5.3 Typage statique Vite 5.0 Build tool Tailwind CSS 3.4 Styling React Router 6.21 Navigation Axios 1.6 HTTP client Recharts 2.10 Graphiques Lucide React 0.312 Ic\u00f4nes"},{"location":"architecture/frontend/#structure-des-dossiers","title":"Structure des dossiers","text":"<pre><code>frontend/src/\n\u251c\u2500\u2500 main.tsx                 # Point d'entr\u00e9e\n\u251c\u2500\u2500 App.tsx                  # Router principal\n\u251c\u2500\u2500 types/\n\u2502   \u2514\u2500\u2500 index.ts             # Interfaces TypeScript\n\u251c\u2500\u2500 services/\n\u2502   \u2514\u2500\u2500 api.ts               # Client Axios + endpoints\n\u251c\u2500\u2500 hooks/\n\u2502   \u2514\u2500\u2500 useAuth.tsx          # Context d'authentification\n\u251c\u2500\u2500 components/\n\u2502   \u251c\u2500\u2500 Layout.tsx           # Layout avec sidebar\n\u2502   \u251c\u2500\u2500 ProtectedRoute.tsx   # Garde de route\n\u2502   \u2514\u2500\u2500 dashboard/           # Composants du dashboard\n\u2502       \u251c\u2500\u2500 StatCard.tsx\n\u2502       \u251c\u2500\u2500 MonthlyChart.tsx\n\u2502       \u251c\u2500\u2500 TagPieChart.tsx\n\u2502       \u251c\u2500\u2500 BudgetProgress.tsx\n\u2502       \u251c\u2500\u2500 TopExpenses.tsx\n\u2502       \u2514\u2500\u2500 TopItems.tsx\n\u2514\u2500\u2500 pages/\n    \u251c\u2500\u2500 LoginPage.tsx\n    \u251c\u2500\u2500 RegisterPage.tsx\n    \u251c\u2500\u2500 DashboardPage.tsx\n    \u251c\u2500\u2500 DocumentsPage.tsx\n    \u251c\u2500\u2500 TagsPage.tsx\n    \u251c\u2500\u2500 BudgetsPage.tsx\n    \u2514\u2500\u2500 SettingsPage.tsx\n</code></pre>"},{"location":"architecture/frontend/#types-typescript","title":"Types TypeScript","text":""},{"location":"architecture/frontend/#entites-principales","title":"Entit\u00e9s principales","text":"<pre><code>interface User {\n  id: number;\n  email: string;\n  name: string | null;\n  created_at: string;\n}\n\ninterface Document {\n  id: number;\n  file_path: string;\n  original_name: string;\n  doc_type?: 'receipt' | 'invoice' | 'payslip' | 'other';\n  date?: string;\n  merchant?: string;\n  total_amount?: number;\n  currency: string;\n  is_income: boolean;\n  tags: Tag[];\n  items: Item[];\n}\n\ninterface Tag {\n  id: number;\n  name: string;\n  color: string;\n  icon?: string;\n}\n\ninterface Budget {\n  id: number;\n  tag_id: number;\n  month: string;\n  limit_amount: number;\n  currency: string;\n}\n</code></pre>"},{"location":"architecture/frontend/#types-de-statistiques","title":"Types de statistiques","text":"<pre><code>interface StatsSummary {\n  month: string;\n  total_expenses: number;\n  total_income: number;\n  balance: number;\n  transaction_count: number;\n}\n\ninterface BudgetWithSpending {\n  id: number;\n  tag_name: string;\n  tag_color: string;\n  limit_amount: number;\n  spent_amount: number;\n  percentage_used: number;\n}\n</code></pre>"},{"location":"architecture/frontend/#client-api","title":"Client API","text":""},{"location":"architecture/frontend/#configuration-axios","title":"Configuration Axios","text":"<pre><code>const apiClient = axios.create({\n  baseURL: 'http://localhost:8000/api/v1',\n  headers: { 'Content-Type': 'application/json' },\n});\n\n// Intercepteur : ajoute le token JWT\napiClient.interceptors.request.use((config) =&gt; {\n  const token = localStorage.getItem('finance_manager_token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// Intercepteur : g\u00e8re les erreurs 401\napiClient.interceptors.response.use(\n  (response) =&gt; response,\n  (error) =&gt; {\n    if (error.response?.status === 401) {\n      localStorage.removeItem('finance_manager_token');\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n</code></pre>"},{"location":"architecture/frontend/#endpoints-disponibles","title":"Endpoints disponibles","text":"<pre><code>// Authentification\nauth.register(data: RegisterData): Promise&lt;User&gt;\nauth.login(credentials: LoginCredentials): Promise&lt;AuthResponse&gt;\nauth.getMe(): Promise&lt;User&gt;\n\n// Documents\ndocuments.list(params?): Promise&lt;DocumentListItem[]&gt;\ndocuments.upload(file: File): Promise&lt;Document&gt;\ndocuments.get(id: number): Promise&lt;Document&gt;\ndocuments.update(id: number, data): Promise&lt;Document&gt;\ndocuments.delete(id: number): Promise&lt;void&gt;\n\n// Tags\ntags.list(): Promise&lt;Tag[]&gt;\ntags.create(data: TagCreate): Promise&lt;Tag&gt;\ntags.update(id: number, data: TagUpdate): Promise&lt;Tag&gt;\ntags.delete(id: number): Promise&lt;void&gt;\n\n// Budgets\nbudgets.list(params?): Promise&lt;Budget[]&gt;\nbudgets.getCurrent(month?: string): Promise&lt;BudgetWithSpending[]&gt;\nbudgets.create(data: BudgetCreate): Promise&lt;Budget&gt;\nbudgets.update(id: number, data: BudgetUpdate): Promise&lt;Budget&gt;\nbudgets.delete(id: number): Promise&lt;void&gt;\n\n// Statistiques\nstats.getSummary(month?: string): Promise&lt;StatsSummary&gt;\nstats.getByTag(month?: string): Promise&lt;StatsByTag[]&gt;\nstats.getMonthly(months?: number): Promise&lt;MonthlyStats[]&gt;\nstats.getTopItems(params?): Promise&lt;TopItem[]&gt;\n\n// Synchronisation\nsync.getStatus(): Promise&lt;SyncStatus&gt;\nsync.testConnection(): Promise&lt;SyncResult&gt;\nsync.runSync(): Promise&lt;SyncRunResult&gt;\n\n// Export\nexportApi.documentsCSV(params?): Promise&lt;void&gt;\nexportApi.monthlyCSV(year: number, month: number): Promise&lt;void&gt;\n</code></pre>"},{"location":"architecture/frontend/#composants","title":"Composants","text":""},{"location":"architecture/frontend/#layout","title":"Layout","text":"<p>Le layout principal avec sidebar responsive :</p> <pre><code>&lt;Layout&gt;\n  &lt;Sidebar&gt;\n    &lt;Logo /&gt;\n    &lt;Navigation /&gt;\n    &lt;UserInfo /&gt;\n  &lt;/Sidebar&gt;\n  &lt;Main&gt;\n    &lt;Header /&gt;\n    &lt;Content&gt;{children}&lt;/Content&gt;\n  &lt;/Main&gt;\n&lt;/Layout&gt;\n</code></pre>"},{"location":"architecture/frontend/#protectedroute","title":"ProtectedRoute","text":"<p>Composant qui prot\u00e8ge les routes authentifi\u00e9es :</p> <pre><code>&lt;ProtectedRoute&gt;\n  &lt;DashboardPage /&gt;\n&lt;/ProtectedRoute&gt;\n</code></pre> <p>Si l'utilisateur n'est pas connect\u00e9, il est redirig\u00e9 vers <code>/login</code>.</p>"},{"location":"architecture/frontend/#composants-dashboard","title":"Composants Dashboard","text":"Composant Description <code>StatCard</code> Carte statistique avec ic\u00f4ne et valeur <code>MonthlyChart</code> Graphique barres d\u00e9penses/revenus <code>TagPieChart</code> Camembert r\u00e9partition par tag <code>BudgetProgress</code> Barres de progression budgets <code>TopExpenses</code> Liste derni\u00e8res d\u00e9penses <code>TopItems</code> Articles les plus fr\u00e9quents"},{"location":"architecture/frontend/#authentification","title":"Authentification","text":""},{"location":"architecture/frontend/#context-auth","title":"Context Auth","text":"<pre><code>const AuthContext = createContext&lt;AuthContextType&gt;(null);\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState&lt;User | null&gt;(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // V\u00e9rifie le token au d\u00e9marrage\n  useEffect(() =&gt; {\n    const token = getToken();\n    if (token) {\n      auth.getMe().then(setUser).catch(() =&gt; removeToken());\n    }\n    setIsLoading(false);\n  }, []);\n\n  const login = async (credentials) =&gt; {\n    const response = await auth.login(credentials);\n    setToken(response.access_token);\n    const user = await auth.getMe();\n    setUser(user);\n  };\n\n  const logout = () =&gt; {\n    removeToken();\n    setUser(null);\n  };\n\n  return (\n    &lt;AuthContext.Provider value={{ user, login, logout, isLoading }}&gt;\n      {children}\n    &lt;/AuthContext.Provider&gt;\n  );\n}\n</code></pre>"},{"location":"architecture/frontend/#utilisation","title":"Utilisation","text":"<pre><code>function MyComponent() {\n  const { user, logout, isAuthenticated } = useAuth();\n\n  if (!isAuthenticated) {\n    return &lt;Navigate to=\"/login\" /&gt;;\n  }\n\n  return (\n    &lt;div&gt;\n      &lt;p&gt;Bonjour {user.name}&lt;/p&gt;\n      &lt;button onClick={logout}&gt;D\u00e9connexion&lt;/button&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"architecture/frontend/#styling","title":"Styling","text":""},{"location":"architecture/frontend/#tailwind-css","title":"Tailwind CSS","text":"<p>Classes utilitaires principales :</p> <pre><code>// Carte\n&lt;div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\"&gt;\n\n// Bouton primaire\n&lt;button className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"&gt;\n\n// Bouton secondaire\n&lt;button className=\"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\"&gt;\n\n// Badge/Tag\n&lt;span className=\"px-2 py-1 rounded-full text-xs font-medium\"\n      style={{ backgroundColor: tag.color }}&gt;\n</code></pre>"},{"location":"architecture/frontend/#palette-de-couleurs","title":"Palette de couleurs","text":"Usage Couleur Primary <code>blue-600</code> Success <code>green-500</code> Warning <code>amber-500</code> Danger <code>red-500</code> Background <code>slate-50</code> Cards <code>white</code>"},{"location":"architecture/overview/","title":"Vue d'ensemble de l'architecture","text":""},{"location":"architecture/overview/#architecture-globale","title":"Architecture globale","text":"<p>Finance Manager est une application web moderne avec une architecture d\u00e9coupl\u00e9e :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         FRONTEND                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                    React 18 + Vite                       \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502    \u2502\n\u2502  \u2502  \u2502Dashboard\u2502 \u2502Documents\u2502 \u2502  Tags   \u2502 \u2502 Budgets \u2502       \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502    \u2502\n\u2502  \u2502                      \u2502                                   \u2502    \u2502\n\u2502  \u2502                \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510                            \u2502    \u2502\n\u2502  \u2502                \u2502  API.ts   \u2502  Axios + JWT               \u2502    \u2502\n\u2502  \u2502                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                            \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502 REST API\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         BACKEND                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                    FastAPI                               \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502    \u2502\n\u2502  \u2502  \u2502                   Routes API                     \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  /auth  /documents  /tags  /budgets  /stats     \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  /export  /sync  /currencies                     \u2502    \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502    \u2502\n\u2502  \u2502                      \u2502                                   \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502    \u2502\n\u2502  \u2502  \u2502                  Services                        \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510       \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  \u2502 OCR \u2502 \u2502 AI  \u2502 \u2502Export\u2502 \u2502Sync \u2502 \u2502Curr.\u2502       \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  \u2514\u2500\u2500\u252c\u2500\u2500\u2518 \u2514\u2500\u2500\u252c\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u252c\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518       \u2502    \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502    \u2502\n\u2502  \u2502        \u2502       \u2502               \u2502                         \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2510 \u250c\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502    \u2502\n\u2502  \u2502  \u2502Paddle  \u2502 \u2502Ollama \u2502   \u2502    rsync    \u2502                 \u2502    \u2502\n\u2502  \u2502  \u2502  OCR   \u2502 \u2502Mistral\u2502   \u2502             \u2502                 \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                      \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502                           \u2502                           \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n    \u2502PostgreSQL \u2502              \u2502     NAS     \u2502                   \u2502\n    \u2502   BDD     \u2502              \u2502  (Ugreen)   \u2502                   \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502\n</code></pre>"},{"location":"architecture/overview/#services-docker","title":"Services Docker","text":"Service Port Description <code>frontend</code> 3000 Application React <code>backend</code> 8000 API FastAPI <code>postgres</code> 5432 Base de donn\u00e9es <code>ollama</code> 11434 Serveur LLM"},{"location":"architecture/overview/#flux-de-donnees","title":"Flux de donn\u00e9es","text":""},{"location":"architecture/overview/#upload-dun-document","title":"Upload d'un document","text":"<pre><code>sequenceDiagram\n    participant U as Utilisateur\n    participant F as Frontend\n    participant B as Backend\n    participant O as OCR\n    participant A as AI\n    participant D as Database\n\n    U-&gt;&gt;F: Upload fichier\n    F-&gt;&gt;B: POST /documents/upload\n    B-&gt;&gt;D: Cr\u00e9er Document (pending)\n    B-&gt;&gt;O: Extraire texte\n    O--&gt;&gt;B: Texte brut\n    B-&gt;&gt;A: Analyser texte\n    A--&gt;&gt;B: Donn\u00e9es structur\u00e9es\n    B-&gt;&gt;D: Mettre \u00e0 jour Document\n    B-&gt;&gt;D: Cr\u00e9er Items\n    B--&gt;&gt;F: Document complet\n    F--&gt;&gt;U: Afficher r\u00e9sultat\n</code></pre>"},{"location":"architecture/overview/#synchronisation-nas","title":"Synchronisation NAS","text":"<pre><code>sequenceDiagram\n    participant U as Utilisateur\n    participant B as Backend\n    participant S as Sync Service\n    participant N as NAS\n    participant D as Database\n\n    U-&gt;&gt;B: POST /sync/run\n    B-&gt;&gt;D: R\u00e9cup\u00e9rer documents non sync\n    loop Pour chaque document\n        B-&gt;&gt;S: sync_file(document)\n        S-&gt;&gt;N: rsync fichier\n        N--&gt;&gt;S: OK\n        S-&gt;&gt;D: synced_to_nas = true\n    end\n    B--&gt;&gt;U: R\u00e9sultats\n</code></pre>"},{"location":"architecture/overview/#modele-de-donnees","title":"Mod\u00e8le de donn\u00e9es","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     User     \u2502       \u2502   Document   \u2502       \u2502     Item     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 id           \u2502\u2500\u2500\u2510    \u2502 id           \u2502\u2500\u2500\u2510    \u2502 id           \u2502\n\u2502 email        \u2502  \u2502    \u2502 user_id      \u2502  \u2502    \u2502 document_id  \u2502\n\u2502 password_hash\u2502  \u2514\u2500\u2500\u2500&gt;\u2502 file_path    \u2502  \u2514\u2500\u2500\u2500&gt;\u2502 name         \u2502\n\u2502 name         \u2502       \u2502 date         \u2502       \u2502 quantity     \u2502\n\u2502 created_at   \u2502       \u2502 merchant     \u2502       \u2502 unit_price   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502 total_amount \u2502       \u2502 total_price  \u2502\n                       \u2502 currency     \u2502       \u2502 category     \u2502\n                       \u2502 is_income    \u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502 synced_to_nas\u2502\n                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u2502 M:N\n                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     Tag      \u2502&lt;\u2500\u2500\u2500\u2500\u2500\u2500\u2502 DocumentTag  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 id           \u2502       \u2502 document_id  \u2502\n\u2502 user_id      \u2502       \u2502 tag_id       \u2502\n\u2502 name         \u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502 color        \u2502\n\u2502 icon         \u2502       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502    Budget    \u2502\n       \u2502               \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502 id           \u2502\n                       \u2502 tag_id       \u2502\n                       \u2502 month        \u2502\n                       \u2502 limit_amount \u2502\n                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/overview/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"architecture/overview/#authentification","title":"Authentification","text":"<ul> <li>JWT (JSON Web Tokens) avec algorithme HS256</li> <li>Tokens valides 7 jours par d\u00e9faut</li> <li>Refresh automatique c\u00f4t\u00e9 frontend</li> </ul>"},{"location":"architecture/overview/#autorisation","title":"Autorisation","text":"<ul> <li>Chaque ressource est li\u00e9e \u00e0 un <code>user_id</code></li> <li>V\u00e9rification syst\u00e9matique dans les routes</li> <li>Pas d'acc\u00e8s aux donn\u00e9es d'autres utilisateurs</li> </ul>"},{"location":"architecture/overview/#protection-des-donnees","title":"Protection des donn\u00e9es","text":"<ul> <li>Mots de passe hash\u00e9s avec bcrypt</li> <li>Validation des entr\u00e9es avec Pydantic</li> <li>\u00c9chappement SQL avec SQLAlchemy</li> </ul>"},{"location":"getting-started/configuration/","title":"Configuration","text":""},{"location":"getting-started/configuration/#variables-denvironnement","title":"Variables d'environnement","text":""},{"location":"getting-started/configuration/#fichier-env","title":"Fichier <code>.env</code>","text":"<p>Le fichier <code>.env</code> \u00e0 la racine du projet contient toutes les configurations :</p> <pre><code># ===========================================\n# S\u00e9curit\u00e9\n# ===========================================\n\n# Cl\u00e9 secr\u00e8te pour signer les tokens JWT\n# IMPORTANT: Changez cette valeur en production !\nSECRET_KEY=your-super-secret-key-change-this-in-production\n\n# ===========================================\n# Base de donn\u00e9es\n# ===========================================\n\n# URL de connexion PostgreSQL\n# Format: postgresql://user:password@host:port/database\nDATABASE_URL=postgresql://finance:finance@postgres:5432/finance_db\n\n# ===========================================\n# Ollama (IA)\n# ===========================================\n\n# URL du service Ollama\nOLLAMA_HOST=http://ollama:11434\n\n# Mod\u00e8le \u00e0 utiliser pour l'extraction\n# Options: mistral, llama2, codellama, etc.\nOLLAMA_MODEL=mistral\n\n# ===========================================\n# Synchronisation NAS (optionnel)\n# ===========================================\n\n# Adresse IP ou hostname du NAS\nNAS_HOST=192.168.1.100\n\n# Utilisateur SSH sur le NAS\nNAS_USER=your-nas-user\n\n# Chemin de destination sur le NAS\nNAS_PATH=/volume1/factures\n\n# Intervalle de sync automatique (minutes)\nSYNC_INTERVAL_MINUTES=30\n</code></pre>"},{"location":"getting-started/configuration/#configuration-du-nas","title":"Configuration du NAS","text":""},{"location":"getting-started/configuration/#prerequis","title":"Pr\u00e9requis","text":"<ol> <li>SSH activ\u00e9 sur votre NAS</li> <li>Cl\u00e9 SSH configur\u00e9e pour l'authentification sans mot de passe</li> <li>rsync install\u00e9 sur le NAS</li> </ol>"},{"location":"getting-started/configuration/#configuration-ssh","title":"Configuration SSH","text":"<pre><code># G\u00e9n\u00e9rer une cl\u00e9 SSH (si pas d\u00e9j\u00e0 fait)\nssh-keygen -t ed25519 -C \"finance-manager\"\n\n# Copier la cl\u00e9 sur le NAS\nssh-copy-id your-user@192.168.1.100\n\n# Tester la connexion\nssh your-user@192.168.1.100 \"echo OK\"\n</code></pre>"},{"location":"getting-started/configuration/#structure-des-dossiers-nas","title":"Structure des dossiers NAS","text":"<p>Les fichiers sont synchronis\u00e9s avec leur nom unique g\u00e9n\u00e9r\u00e9 :</p> <pre><code>/volume1/factures/\n\u251c\u2500\u2500 2024-01-15_abc123_ticket-supermarche.jpg\n\u251c\u2500\u2500 2024-01-20_def456_facture-electricite.pdf\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"getting-started/configuration/#configuration-des-budgets","title":"Configuration des budgets","text":""},{"location":"getting-started/configuration/#creation-dun-budget","title":"Cr\u00e9ation d'un budget","text":"<ol> <li>Cr\u00e9ez d'abord les tags correspondant \u00e0 vos cat\u00e9gories</li> <li>Allez dans Budgets &gt; Nouveau budget</li> <li>S\u00e9lectionnez le tag et d\u00e9finissez la limite mensuelle</li> </ol>"},{"location":"getting-started/configuration/#alertes-visuelles","title":"Alertes visuelles","text":"Pourcentage utilis\u00e9 Couleur Signification 0-50% Vert Tout va bien 50-75% Jaune Attention 75-90% Orange Proche de la limite 90%+ Rouge Limite d\u00e9pass\u00e9e"},{"location":"getting-started/configuration/#configuration-frontend","title":"Configuration frontend","text":""},{"location":"getting-started/configuration/#fichier-frontendenv","title":"Fichier <code>frontend/.env</code>","text":"<pre><code># URL de l'API backend\nVITE_API_URL=http://localhost:8000/api/v1\n</code></pre>"},{"location":"getting-started/configuration/#build-de-production","title":"Build de production","text":"<pre><code>cd frontend\nnpm run build\n</code></pre> <p>Les fichiers statiques sont g\u00e9n\u00e9r\u00e9s dans <code>frontend/dist/</code>.</p>"},{"location":"getting-started/configuration/#personnalisation","title":"Personnalisation","text":""},{"location":"getting-started/configuration/#modifier-les-devises-par-defaut","title":"Modifier les devises par d\u00e9faut","text":"<p>\u00c9ditez la migration <code>backend/alembic/versions/001_initial_schema.py</code> avant la premi\u00e8re ex\u00e9cution pour modifier les devises :</p> <pre><code>currencies = [\n    {\"code\": \"EUR\", \"name\": \"Euro\", \"symbol\": \"\u20ac\", \"rate_to_eur\": 1.0},\n    {\"code\": \"USD\", \"name\": \"Dollar US\", \"symbol\": \"$\", \"rate_to_eur\": 0.92},\n    # Ajoutez vos devises ici\n]\n</code></pre>"},{"location":"getting-started/configuration/#modifier-le-prompt-ia","title":"Modifier le prompt IA","text":"<p>Le prompt d'extraction est dans <code>backend/app/services/ai_service.py</code>. Vous pouvez l'adapter pour am\u00e9liorer l'extraction selon vos types de documents.</p>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Docker et Docker Compose install\u00e9s</li> <li>Mac M1/M2 ou Linux (architecture ARM64 ou AMD64)</li> <li>Au moins 8 Go de RAM (pour Ollama)</li> <li>10 Go d'espace disque (mod\u00e8les IA + donn\u00e9es)</li> </ul>"},{"location":"getting-started/installation/#installation-avec-docker","title":"Installation avec Docker","text":""},{"location":"getting-started/installation/#1-cloner-le-projet","title":"1. Cloner le projet","text":"<pre><code>git clone &lt;repository-url&gt;\ncd gestionnaireDeFinance\n</code></pre>"},{"location":"getting-started/installation/#2-configurer-lenvironnement","title":"2. Configurer l'environnement","text":"<pre><code># Copier le fichier d'exemple\ncp .env.example .env\n\n# \u00c9diter les variables (optionnel)\nnano .env\n</code></pre> <p>Variables importantes :</p> Variable Description D\u00e9faut <code>SECRET_KEY</code> Cl\u00e9 secr\u00e8te JWT \u00c0 changer en production <code>DATABASE_URL</code> URL PostgreSQL Configur\u00e9 pour Docker <code>OLLAMA_MODEL</code> Mod\u00e8le LLM <code>mistral</code> <code>NAS_HOST</code> IP du NAS Vide (optionnel)"},{"location":"getting-started/installation/#3-lancer-les-services","title":"3. Lancer les services","text":"<pre><code># D\u00e9marrer tous les services\ndocker-compose up -d\n\n# Voir les logs\ndocker-compose logs -f\n</code></pre>"},{"location":"getting-started/installation/#4-initialiser-la-base-de-donnees","title":"4. Initialiser la base de donn\u00e9es","text":"<pre><code># Ex\u00e9cuter les migrations\ndocker-compose exec backend alembic upgrade head\n</code></pre>"},{"location":"getting-started/installation/#5-telecharger-le-modele-ia","title":"5. T\u00e9l\u00e9charger le mod\u00e8le IA","text":"<pre><code># T\u00e9l\u00e9charger Mistral (3.8 Go)\ndocker-compose exec ollama ollama pull mistral\n</code></pre> <p>Premier t\u00e9l\u00e9chargement</p> <p>Le t\u00e9l\u00e9chargement du mod\u00e8le peut prendre plusieurs minutes selon votre connexion.</p>"},{"location":"getting-started/installation/#verification","title":"V\u00e9rification","text":""},{"location":"getting-started/installation/#acces-aux-services","title":"Acc\u00e8s aux services","text":"Service URL Description Frontend http://localhost:3000 Interface utilisateur Backend http://localhost:8000 API REST Swagger http://localhost:8000/docs Documentation API Ollama http://localhost:11434 API LLM"},{"location":"getting-started/installation/#test-de-lapi","title":"Test de l'API","text":"<pre><code># V\u00e9rifier que l'API r\u00e9pond\ncurl http://localhost:8000/health\n\n# R\u00e9ponse attendue\n{\"status\": \"healthy\"}\n</code></pre>"},{"location":"getting-started/installation/#commandes-utiles","title":"Commandes utiles","text":"<pre><code># Arr\u00eater les services\ndocker-compose down\n\n# Reconstruire les images\ndocker-compose build --no-cache\n\n# Voir l'\u00e9tat des conteneurs\ndocker-compose ps\n\n# Acc\u00e9der au shell du backend\ndocker-compose exec backend bash\n\n# Voir les logs d'un service\ndocker-compose logs -f backend\n</code></pre>"},{"location":"getting-started/installation/#depannage","title":"D\u00e9pannage","text":""},{"location":"getting-started/installation/#erreur-de-connexion-a-postgresql","title":"Erreur de connexion \u00e0 PostgreSQL","text":"<pre><code># V\u00e9rifier que postgres est d\u00e9marr\u00e9\ndocker-compose ps postgres\n\n# Recr\u00e9er le conteneur si n\u00e9cessaire\ndocker-compose rm -f postgres\ndocker-compose up -d postgres\n</code></pre>"},{"location":"getting-started/installation/#ollama-ne-repond-pas","title":"Ollama ne r\u00e9pond pas","text":"<pre><code># V\u00e9rifier les logs\ndocker-compose logs ollama\n\n# Le mod\u00e8le est-il t\u00e9l\u00e9charg\u00e9 ?\ndocker-compose exec ollama ollama list\n</code></pre>"},{"location":"getting-started/installation/#ocr-lent-sur-mac-m1","title":"OCR lent sur Mac M1","text":"<p>PaddleOCR utilise le CPU par d\u00e9faut. Les performances sont acceptables mais pas optimales. Pour des documents complexes, pr\u00e9voyez quelques secondes de traitement.</p>"},{"location":"services/ai/","title":"Service IA","text":"<p>Le service IA utilise Ollama avec le mod\u00e8le Mistral pour analyser le texte OCR et extraire des donn\u00e9es structur\u00e9es.</p>"},{"location":"services/ai/#fichier-source","title":"Fichier source","text":"<p><code>backend/app/services/ai_service.py</code></p>"},{"location":"services/ai/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>Analyse du texte brut extrait par OCR</li> <li>Extraction structur\u00e9e des informations</li> <li>Cat\u00e9gorisation automatique du type de document</li> <li>Identification des articles individuels</li> </ul>"},{"location":"services/ai/#classes","title":"Classes","text":""},{"location":"services/ai/#extractionresult","title":"ExtractionResult","text":"<p>R\u00e9sultat de l'extraction IA.</p> <pre><code>@dataclass\nclass ExtractionResult:\n    doc_type: str           # receipt, invoice, payslip, other\n    date: date | None\n    time: time | None\n    merchant: str | None\n    location: str | None\n    items: list[ExtractedItem]\n    total_amount: Decimal | None\n    currency: str\n    is_income: bool\n    confidence: float\n</code></pre>"},{"location":"services/ai/#extracteditem","title":"ExtractedItem","text":"<p>Article extrait d'un document.</p> <pre><code>@dataclass\nclass ExtractedItem:\n    name: str\n    quantity: Decimal\n    unit: str | None\n    unit_price: Decimal | None\n    total_price: Decimal | None\n    category: str | None\n</code></pre>"},{"location":"services/ai/#aiservice","title":"AIService","text":"<p>Service principal d'analyse.</p> <pre><code>class AIService:\n    def __init__(self):\n        \"\"\"Initialise le client Ollama.\"\"\"\n        self.client = httpx.AsyncClient(\n            base_url=settings.ollama_host,\n            timeout=120.0\n        )\n        self.model = settings.ollama_model\n\n    async def extract_structured_data(self, raw_text: str) -&gt; ExtractionResult:\n        \"\"\"\n        Analyse le texte OCR et extrait les donn\u00e9es.\n\n        Args:\n            raw_text: Texte brut issu de l'OCR\n\n        Returns:\n            ExtractionResult avec toutes les donn\u00e9es extraites\n        \"\"\"\n</code></pre>"},{"location":"services/ai/#prompt-dextraction","title":"Prompt d'extraction","text":"<p>Le prompt utilis\u00e9 pour l'extraction :</p> <pre><code>Tu es un assistant sp\u00e9cialis\u00e9 dans l'analyse de documents financiers.\nAnalyse le texte suivant extrait par OCR d'un document et retourne les informations au format JSON.\n\nLe JSON doit contenir :\n- doc_type: \"receipt\" | \"invoice\" | \"payslip\" | \"other\"\n- date: \"YYYY-MM-DD\" ou null\n- time: \"HH:MM:SS\" ou null\n- merchant: nom du commerce/entreprise ou null\n- location: adresse/ville ou null\n- items: liste d'articles [{ name, quantity, unit, unit_price, total_price, category }]\n- total_amount: montant total ou null\n- currency: code devise (EUR, USD...) d\u00e9faut EUR\n- is_income: true si c'est un revenu (salaire, remboursement...), false sinon\n\nTexte \u00e0 analyser :\n{raw_text}\n\nR\u00e9ponds UNIQUEMENT avec le JSON, sans texte avant ou apr\u00e8s.\n</code></pre>"},{"location":"services/ai/#utilisation","title":"Utilisation","text":"<pre><code>from app.services.ai_service import get_ai_service\n\n# Obtenir une instance du service\nai = get_ai_service()\n\n# Analyser du texte OCR\nresult = await ai.extract_structured_data(\"\"\"\nCARREFOUR\nParis 15e\n15/01/2024 14:30\n\nPommes Golden 1.5kg    4.49\nBaguette x2            2.40\nLait 1L                1.10\n\nTOTAL                  7.99\nCB ****1234\n\"\"\")\n\nprint(f\"Marchand: {result.merchant}\")  # Carrefour\nprint(f\"Total: {result.total_amount}\")  # 7.99\nprint(f\"Articles: {len(result.items)}\")  # 3\n</code></pre>"},{"location":"services/ai/#configuration","title":"Configuration","text":""},{"location":"services/ai/#variables-denvironnement","title":"Variables d'environnement","text":"<pre><code>OLLAMA_HOST=http://ollama:11434\nOLLAMA_MODEL=mistral\n</code></pre>"},{"location":"services/ai/#modeles-supportes","title":"Mod\u00e8les support\u00e9s","text":"Mod\u00e8le Taille Performance Notes mistral 4.1 GB Excellent Recommand\u00e9 llama2 3.8 GB Bon Alternative phi 1.6 GB Correct L\u00e9ger"},{"location":"services/ai/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<pre><code>try:\n    result = await ai.extract_structured_data(text)\nexcept httpx.ConnectError:\n    # Ollama non accessible\nexcept httpx.TimeoutException:\n    # Timeout (&gt;2 min)\nexcept json.JSONDecodeError:\n    # R\u00e9ponse non-JSON du mod\u00e8le\n</code></pre>"},{"location":"services/ai/#fallback","title":"Fallback","text":"<p>En cas d'\u00e9chec de l'IA, le service retourne un r\u00e9sultat minimal :</p> <pre><code>ExtractionResult(\n    doc_type=\"other\",\n    items=[],\n    currency=\"EUR\",\n    is_income=False,\n    confidence=0.0\n)\n</code></pre> <p>Le document est quand m\u00eame cr\u00e9\u00e9 avec le texte OCR brut, permettant une correction manuelle ult\u00e9rieure.</p>"},{"location":"services/ai/#performances","title":"Performances","text":"Type de document Temps moyen Pr\u00e9cision Ticket simple 3-5s 90%+ Facture complexe 5-10s 85%+ Fiche de paie 8-15s 80%+"},{"location":"services/ai/#amelioration-des-resultats","title":"Am\u00e9lioration des r\u00e9sultats","text":""},{"location":"services/ai/#pretraitement-du-texte","title":"Pr\u00e9traitement du texte","text":"<pre><code>def preprocess_ocr_text(text: str) -&gt; str:\n    \"\"\"Nettoie le texte OCR avant analyse.\"\"\"\n    # Supprimer les lignes vides multiples\n    text = re.sub(r'\\n{3,}', '\\n\\n', text)\n    # Corriger les espaces multiples\n    text = re.sub(r' {2,}', ' ', text)\n    return text.strip()\n</code></pre>"},{"location":"services/ai/#post-traitement","title":"Post-traitement","text":"<p>Apr\u00e8s extraction, des validations sont appliqu\u00e9es :</p> <ul> <li>Dates impossibles corrig\u00e9es (ex: 32/01 \u2192 null)</li> <li>Montants n\u00e9gatifs signal\u00e9s</li> <li>Devises non reconnues \u2192 EUR par d\u00e9faut</li> </ul>"},{"location":"services/export/","title":"Service Export","text":"<p>Le service d'export g\u00e9n\u00e8re des fichiers CSV \u00e0 partir des donn\u00e9es.</p>"},{"location":"services/export/#fichier-source","title":"Fichier source","text":"<p><code>backend/app/services/export_service.py</code></p>"},{"location":"services/export/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>Export des documents en CSV</li> <li>Export du r\u00e9sum\u00e9 mensuel</li> <li>Filtrage par dates, tags</li> <li>Option d\u00e9tail des articles</li> </ul>"},{"location":"services/export/#classe-exportservice","title":"Classe ExportService","text":"<pre><code>class ExportService:\n    def __init__(self, db: Session, user_id: int):\n        \"\"\"\n        Initialise le service d'export.\n\n        Args:\n            db: Session de base de donn\u00e9es\n            user_id: ID de l'utilisateur (filtre les donn\u00e9es)\n        \"\"\"\n\n    def export_documents_csv(\n        self,\n        start_date: date | None = None,\n        end_date: date | None = None,\n        tag_ids: list[int] | None = None,\n        include_items: bool = False\n    ) -&gt; str:\n        \"\"\"\n        Exporte les documents en CSV.\n\n        Returns:\n            Contenu CSV sous forme de cha\u00eene\n        \"\"\"\n\n    def export_monthly_summary_csv(\n        self,\n        year: int,\n        month: int\n    ) -&gt; str:\n        \"\"\"\n        Exporte le r\u00e9sum\u00e9 mensuel en CSV.\n\n        Returns:\n            Contenu CSV avec totaux et r\u00e9partition\n        \"\"\"\n</code></pre>"},{"location":"services/export/#utilisation","title":"Utilisation","text":"<pre><code>from app.services.export_service import get_export_service\n\n# Cr\u00e9er le service\nexport_service = get_export_service(db, user_id=1)\n\n# Export des documents\ncsv_content = export_service.export_documents_csv(\n    start_date=date(2024, 1, 1),\n    end_date=date(2024, 1, 31),\n    tag_ids=[1, 2],\n    include_items=True\n)\n\n# Sauvegarder le fichier\nwith open(\"export.csv\", \"w\", encoding=\"utf-8-sig\") as f:\n    f.write(csv_content)\n</code></pre>"},{"location":"services/export/#formats-de-sortie","title":"Formats de sortie","text":""},{"location":"services/export/#export-documents-sans-items","title":"Export documents (sans items)","text":"<pre><code>ID;Date;Heure;Marchand;Lieu;Type;Montant;Devise;Type transaction;Tags;Fichier original\n1;2024-01-15;14:30:00;Carrefour;Paris;receipt;45.67;EUR;D\u00e9pense;Courses;ticket.jpg\n</code></pre> Colonne Description ID Identifiant unique Date Date du document (YYYY-MM-DD) Heure Heure si disponible (HH:MM:SS) Marchand Nom du commerce Lieu Adresse/ville Type Type de document Montant Montant total Devise Code devise (EUR, USD...) Type transaction Revenu ou D\u00e9pense Tags Tags s\u00e9par\u00e9s par virgule Fichier original Nom du fichier upload\u00e9"},{"location":"services/export/#export-documents-avec-items","title":"Export documents (avec items)","text":"<pre><code>ID Document;Date;Marchand;Article;Quantit\u00e9;Unit\u00e9;Prix unitaire;Prix total;Cat\u00e9gorie article;Tags document\n1;2024-01-15;Carrefour;Pommes Golden;1.50;kg;2.99;4.49;Fruits;Courses\n1;2024-01-15;Carrefour;Baguette;2.00;;1.20;2.40;Boulangerie;Courses\n</code></pre>"},{"location":"services/export/#export-mensuel","title":"Export mensuel","text":"<pre><code>R\u00e9sum\u00e9 mensuel;2024-01\n\nM\u00e9trique;Valeur\nTotal d\u00e9penses;1250.75 EUR\nTotal revenus;3500.00 EUR\nSolde;2249.25 EUR\nNombre de transactions;42\n\nD\u00e9penses par cat\u00e9gorie\nTag;Montant;Pourcentage\nCourses;450.30 EUR;36.0%\nTransport;180.00 EUR;14.4%\n</code></pre>"},{"location":"services/export/#configuration-csv","title":"Configuration CSV","text":"<pre><code># S\u00e9parateur : point-virgule (Excel FR)\nwriter = csv.writer(output, delimiter=';', quoting=csv.QUOTE_MINIMAL)\n</code></pre>"},{"location":"services/export/#encodage","title":"Encodage","text":"<p>Les fichiers sont g\u00e9n\u00e9r\u00e9s en UTF-8 avec BOM pour compatibilit\u00e9 Excel :</p> <pre><code># Dans la route API\nreturn StreamingResponse(\n    iter([csv_content]),\n    media_type=\"text/csv; charset=utf-8\",\n    headers={\n        \"Content-Disposition\": f'attachment; filename=\"{filename}\"',\n    }\n)\n</code></pre>"},{"location":"services/export/#performances","title":"Performances","text":"Nombre de documents Temps de g\u00e9n\u00e9ration 100 &lt; 1s 1000 2-3s 10000 10-15s <p>Pour les gros exports, la g\u00e9n\u00e9ration est faite en streaming pour \u00e9viter les probl\u00e8mes de m\u00e9moire.</p>"},{"location":"services/nas-sync/","title":"Service NAS Sync","text":"<p>Le service de synchronisation NAS transf\u00e8re les fichiers vers un NAS distant via rsync.</p>"},{"location":"services/nas-sync/#fichier-source","title":"Fichier source","text":"<p><code>backend/app/services/nas_sync_service.py</code></p>"},{"location":"services/nas-sync/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>Test de connexion SSH</li> <li>Synchronisation fichier par fichier</li> <li>Synchronisation batch</li> <li>Suivi du statut en base de donn\u00e9es</li> </ul>"},{"location":"services/nas-sync/#configuration-requise","title":"Configuration requise","text":""},{"location":"services/nas-sync/#variables-denvironnement","title":"Variables d'environnement","text":"<pre><code># Adresse IP ou hostname du NAS\nNAS_HOST=192.168.1.100\n\n# Utilisateur SSH\nNAS_USER=admin\n\n# Chemin de destination\nNAS_PATH=/volume1/factures\n</code></pre>"},{"location":"services/nas-sync/#prerequis-nas","title":"Pr\u00e9requis NAS","text":"<ol> <li>SSH activ\u00e9 sur le NAS</li> <li>rsync install\u00e9 (g\u00e9n\u00e9ralement inclus)</li> <li>Cl\u00e9 SSH configur\u00e9e pour authentification sans mot de passe</li> </ol>"},{"location":"services/nas-sync/#configuration-de-la-cle-ssh","title":"Configuration de la cl\u00e9 SSH","text":"<pre><code># G\u00e9n\u00e9rer une cl\u00e9 (si n\u00e9cessaire)\nssh-keygen -t ed25519 -C \"finance-manager\"\n\n# Copier sur le NAS\nssh-copy-id admin@192.168.1.100\n\n# Tester\nssh admin@192.168.1.100 \"echo OK\"\n</code></pre>"},{"location":"services/nas-sync/#classes","title":"Classes","text":""},{"location":"services/nas-sync/#nassyncerror","title":"NASSyncError","text":"<p>Exception personnalis\u00e9e pour les erreurs de synchronisation.</p> <pre><code>class NASSyncError(Exception):\n    def __init__(self, message: str, details: str | None = None):\n        self.message = message\n        self.details = details\n</code></pre>"},{"location":"services/nas-sync/#nassyncservice","title":"NASSyncService","text":"<p>Service principal de synchronisation.</p> <pre><code>class NASSyncService:\n    def is_configured(self) -&gt; bool:\n        \"\"\"V\u00e9rifie si le NAS est configur\u00e9.\"\"\"\n\n    def get_config_status(self) -&gt; dict:\n        \"\"\"Retourne le statut de la configuration.\"\"\"\n\n    def test_connection(self) -&gt; tuple[bool, str]:\n        \"\"\"Teste la connexion SSH.\"\"\"\n\n    def sync_file(self, document: Document) -&gt; tuple[bool, str]:\n        \"\"\"Synchronise un fichier sp\u00e9cifique.\"\"\"\n\n    def sync_all_pending(self, user_id: int) -&gt; dict:\n        \"\"\"Synchronise tous les fichiers en attente.\"\"\"\n\n    def get_sync_stats(self, user_id: int) -&gt; dict:\n        \"\"\"Retourne les statistiques de synchronisation.\"\"\"\n</code></pre>"},{"location":"services/nas-sync/#utilisation","title":"Utilisation","text":"<pre><code>from app.services.nas_sync_service import get_nas_sync_service\n\n# Cr\u00e9er le service\nsync_service = get_nas_sync_service(db)\n\n# V\u00e9rifier la configuration\nif not sync_service.is_configured():\n    print(\"NAS non configur\u00e9\")\n    return\n\n# Tester la connexion\nsuccess, message = sync_service.test_connection()\nif not success:\n    print(f\"Erreur: {message}\")\n    return\n\n# Synchroniser un document\ndocument = db.query(Document).get(1)\nsuccess, message = sync_service.sync_file(document)\n\n# Synchroniser tous les documents en attente\nresults = sync_service.sync_all_pending(user_id=1)\nprint(f\"Synchronis\u00e9s: {results['synced']}\")\nprint(f\"\u00c9checs: {results['failed']}\")\n</code></pre>"},{"location":"services/nas-sync/#commande-rsync","title":"Commande rsync","text":"<p>La synchronisation utilise rsync avec les options suivantes :</p> <pre><code>rsync -avz --progress \\\n  -e \"ssh -o BatchMode=yes -o ConnectTimeout=30\" \\\n  /app/uploads/document.jpg \\\n  user@nas:/volume1/factures/document.jpg\n</code></pre> Option Description -a Mode archive (pr\u00e9serve m\u00e9tadonn\u00e9es) -v Mode verbose -z Compression pendant le transfert --progress Affiche la progression BatchMode=yes Pas de prompt interactif ConnectTimeout=30 Timeout de connexion 30s"},{"location":"services/nas-sync/#mise-a-jour-en-base","title":"Mise \u00e0 jour en base","text":"<p>Apr\u00e8s synchronisation r\u00e9ussie :</p> <pre><code>document.synced_to_nas = True\ndocument.synced_at = datetime.utcnow()\ndb.commit()\n</code></pre>"},{"location":"services/nas-sync/#gestion-des-erreurs","title":"Gestion des erreurs","text":""},{"location":"services/nas-sync/#erreurs-courantes","title":"Erreurs courantes","text":"Erreur Cause Solution Permission denied Cl\u00e9 SSH non configur\u00e9e Configurer ssh-copy-id Connection refused SSH non activ\u00e9 Activer SSH sur le NAS Connection timeout NAS inaccessible V\u00e9rifier le r\u00e9seau No such file Chemin invalide V\u00e9rifier NAS_PATH"},{"location":"services/nas-sync/#timeout","title":"Timeout","text":"<ul> <li>Connexion SSH : 30 secondes</li> <li>Transfert par fichier : 5 minutes</li> </ul>"},{"location":"services/nas-sync/#statistiques","title":"Statistiques","text":"<pre><code>stats = sync_service.get_sync_stats(user_id=1)\n\n# Exemple de retour\n{\n    \"total_documents\": 150,\n    \"synced\": 142,\n    \"pending\": 8,\n    \"sync_percentage\": 94.7,\n    \"last_sync\": \"2024-01-15T14:30:00\",\n    \"nas_configured\": True\n}\n</code></pre>"},{"location":"services/nas-sync/#bonnes-pratiques","title":"Bonnes pratiques","text":""},{"location":"services/nas-sync/#securite","title":"S\u00e9curit\u00e9","text":"<ul> <li>Utiliser une cl\u00e9 SSH d\u00e9di\u00e9e</li> <li>Limiter les permissions sur le NAS</li> <li>Ne pas exposer le NAS sur Internet</li> </ul>"},{"location":"services/nas-sync/#performance","title":"Performance","text":"<ul> <li>Synchroniser r\u00e9guli\u00e8rement (\u00e9viter les gros batchs)</li> <li>Utiliser une connexion r\u00e9seau stable</li> <li>Pr\u00e9voir suffisamment d'espace sur le NAS</li> </ul>"},{"location":"services/nas-sync/#fiabilite","title":"Fiabilit\u00e9","text":"<ul> <li>V\u00e9rifier les logs en cas d'\u00e9chec</li> <li>Impl\u00e9menter des retries automatiques (\u00e0 venir)</li> <li>Monitorer l'espace disque NAS</li> </ul>"},{"location":"services/ocr/","title":"Service OCR","text":"<p>Le service OCR utilise PaddleOCR pour extraire le texte des documents.</p>"},{"location":"services/ocr/#fichier-source","title":"Fichier source","text":"<p><code>backend/app/services/ocr_service.py</code></p>"},{"location":"services/ocr/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>Extraction de texte depuis images (JPG, PNG, WEBP, BMP)</li> <li>Extraction de texte depuis PDF (conversion en images)</li> <li>Score de confiance pour chaque extraction</li> <li>Support multilingue (fran\u00e7ais, anglais)</li> </ul>"},{"location":"services/ocr/#classes","title":"Classes","text":""},{"location":"services/ocr/#ocrresult","title":"OCRResult","text":"<p>R\u00e9sultat d'une extraction OCR.</p> <pre><code>@dataclass\nclass OCRResult:\n    text: str           # Texte extrait\n    confidence: float   # Score de confiance (0-100)\n    success: bool       # Extraction r\u00e9ussie\n    error: str | None   # Message d'erreur si \u00e9chec\n</code></pre>"},{"location":"services/ocr/#ocrservice","title":"OCRService","text":"<p>Service principal d'extraction.</p> <pre><code>class OCRService:\n    def __init__(self):\n        \"\"\"Initialise PaddleOCR avec les param\u00e8tres optimaux.\"\"\"\n        self.ocr = PaddleOCR(\n            use_angle_cls=True,  # Correction d'orientation\n            lang='fr',            # Langue fran\u00e7aise\n            use_gpu=False         # CPU uniquement\n        )\n\n    def extract_text(self, file_path: str) -&gt; OCRResult:\n        \"\"\"\n        Extrait le texte d'un fichier.\n\n        Args:\n            file_path: Chemin absolu vers le fichier\n\n        Returns:\n            OCRResult avec le texte et le score de confiance\n        \"\"\"\n</code></pre>"},{"location":"services/ocr/#utilisation","title":"Utilisation","text":"<pre><code>from app.services.ocr_service import get_ocr_service\n\n# Obtenir une instance du service\nocr = get_ocr_service()\n\n# Extraire le texte d'une image\nresult = ocr.extract_text(\"/path/to/ticket.jpg\")\n\nif result.success:\n    print(f\"Texte: {result.text}\")\n    print(f\"Confiance: {result.confidence}%\")\nelse:\n    print(f\"Erreur: {result.error}\")\n</code></pre>"},{"location":"services/ocr/#traitement-des-pdf","title":"Traitement des PDF","text":"<p>Les fichiers PDF sont convertis en images avant l'extraction :</p> <pre><code>def _extract_from_pdf(self, file_path: str) -&gt; OCRResult:\n    \"\"\"\n    Convertit le PDF en images et extrait le texte.\n\n    Utilise pdf2image pour la conversion.\n    Traite chaque page s\u00e9par\u00e9ment et concat\u00e8ne les r\u00e9sultats.\n    \"\"\"\n</code></pre>"},{"location":"services/ocr/#configuration","title":"Configuration","text":""},{"location":"services/ocr/#parametres-paddleocr","title":"Param\u00e8tres PaddleOCR","text":"Param\u00e8tre Valeur Description use_angle_cls True D\u00e9tection et correction de l'orientation lang fr Langue du mod\u00e8le use_gpu False Utilisation CPU (compatible M1) show_log False Logs d\u00e9sactiv\u00e9s"},{"location":"services/ocr/#performances","title":"Performances","text":"Type de document Temps moyen Confiance moyenne Ticket de caisse 1-2s 85-95% Facture PDF 2-4s 90-98% Photo floue 2-3s 60-80%"},{"location":"services/ocr/#formats-supportes","title":"Formats support\u00e9s","text":"Format Extension Notes JPEG .jpg, .jpeg Format recommand\u00e9 PNG .png Bonne qualit\u00e9 WebP .webp Compact BMP .bmp Non compress\u00e9 PDF .pdf Converti en images"},{"location":"services/ocr/#gestion-des-erreurs","title":"Gestion des erreurs","text":"<pre><code>try:\n    result = ocr.extract_text(file_path)\nexcept FileNotFoundError:\n    # Fichier introuvable\nexcept PermissionError:\n    # Acc\u00e8s refus\u00e9\nexcept Exception as e:\n    # Erreur OCR interne\n</code></pre>"},{"location":"services/ocr/#optimisation","title":"Optimisation","text":""},{"location":"services/ocr/#conseils-pour-de-meilleurs-resultats","title":"Conseils pour de meilleurs r\u00e9sultats","text":"<ol> <li>Qualit\u00e9 d'image : R\u00e9solution minimale 300 DPI</li> <li>\u00c9clairage : \u00c9viter les ombres et reflets</li> <li>Orientation : Le texte doit \u00eatre lisible (PaddleOCR corrige jusqu'\u00e0 90\u00b0)</li> <li>Contraste : Texte noir sur fond blanc id\u00e9al</li> </ol>"},{"location":"services/ocr/#pretraitement-recommande","title":"Pr\u00e9traitement recommand\u00e9","text":"<p>Pour des cas difficiles, un pr\u00e9traitement peut am\u00e9liorer les r\u00e9sultats :</p> <pre><code>from PIL import Image, ImageEnhance\n\n# Am\u00e9liorer le contraste\nimg = Image.open(file_path)\nenhancer = ImageEnhance.Contrast(img)\nimg = enhancer.enhance(1.5)\n\n# Convertir en niveaux de gris\nimg = img.convert('L')\n</code></pre>"}]}